<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Tools/XVGeometry.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Tools/XVGeometry.h</h1><div class="fragment"><pre>00001 <font class="comment">// *** BEGIN_XVISION2_COPYRIGHT_NOTICE ***</font>
00002 <font class="comment">// *** END_XVISION2_COPYRIGHT_NOTICE ***</font>
00003 
00004 <font class="preprocessor">#ifndef _XVGEOMETRY_H_
</font>00005 <font class="preprocessor"></font><font class="preprocessor">#define _XVGEOMETRY_H_
</font>00006 <font class="preprocessor"></font>
00007 <font class="preprocessor">#include &lt;sys/types.h&gt;</font>
00008 <font class="preprocessor">#include &lt;math.h&gt;</font>
00009 
00011 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
<a name="l00012"></a><a class="code" href="class_XV2Vec.html">00012</a> <font class="keyword">class </font><a class="code" href="class_XV2Vec.html">XV2Vec</a> {
00013 
00014 <font class="keyword">protected</font>:
00015 
00016   T posx;
00017   T posy;
00018 
00019 <font class="keyword">public</font>:
00020 
00021   <font class="keyword">inline</font> <font class="keyword">const</font> T &amp; PosX()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> posx; }
00022   <font class="keyword">inline</font> <font class="keyword">const</font> T &amp; PosY()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> posy; }
00023 
00024   <font class="keyword">inline</font> <font class="keyword">const</font> T &amp; x()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> posx; }
00025   <font class="keyword">inline</font> <font class="keyword">const</font> T &amp; y()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> posy; }
00026 
00027   <font class="keyword">inline</font> XV2Vec(<font class="keyword">const</font> T px, <font class="keyword">const</font> T py)<font class="keyword"> </font>{
00028     posx = px;
00029     posy = py;
00030   }
00031 
00032   <font class="keyword">inline</font> XV2Vec(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a> &amp; xvp)<font class="keyword"> </font>{
00033     posx = xvp.posx;
00034     posy = xvp.posy;
00035   }
00036 
00037   <font class="keyword">inline</font> XV2Vec()<font class="keyword"> </font>{
00038     posx = 0;
00039     posy = 0;
00040   }
00041 
00042   <font class="keyword">inline</font> <font class="keywordtype">void</font> setX(T val)<font class="keyword"> </font>{ posx = val; }
00043   <font class="keyword">inline</font> <font class="keywordtype">void</font> setY(T val)<font class="keyword"> </font>{ posy = val; }
00044 
00045   <font class="keyword">inline</font> <font class="keyword">virtual</font> <font class="keywordtype">void</font> reposition(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; xvp)<font class="keyword"> </font>{
00046     posx = xvp.posx;
00047     posy = xvp.posy;
00048   }
00049 
00050   <font class="keyword">inline</font> <font class="keyword">virtual</font> <font class="keywordtype">void</font> reposition(<font class="keyword">const</font> T px, <font class="keyword">const</font> T py)<font class="keyword"> </font>{
00051     posx = px;
00052     posy = py;
00053   }
00054 
00055   <font class="keyword">inline</font> <font class="keywordtype">double</font> length()<font class="keyword"> const </font>{
00056 
00057     <font class="keywordflow">return</font> sqrt((<font class="keywordtype">double</font>)posx * posx + posy * posy);
00058   };
00059  
00060   <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; operator = (<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; xvp)<font class="keyword"> </font>{
00061     posx = xvp.posx;
00062     posy = xvp.posy;
00063     <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00064   }
00065 
00066 <font class="preprocessor">#define MAKE_XV2VEC_OP_XV2VEC(_OP_) \
</font>00067 <font class="preprocessor">  inline XV2Vec&lt;T&gt; &amp; operator _OP_ (const XV2Vec&lt;T&gt; &amp; p){ \
</font>00068 <font class="preprocessor">    posx _OP_ p.PosX();  posy _OP_ p.PosY(); return *this; \
</font>00069 <font class="preprocessor">  };
</font>00070 <font class="preprocessor"></font>
00071 MAKE_XV2VEC_OP_XV2VEC(+=);
00072 MAKE_XV2VEC_OP_XV2VEC(-=);
00073 
00074 <font class="preprocessor">#define MAKE_XV2VEC_OP_VAL(_OP_) \
</font>00075 <font class="preprocessor">  inline XV2Vec&lt;T&gt; &amp; operator _OP_  (T val){ \
</font>00076 <font class="preprocessor">    posx _OP_ val;  posy _OP_ val; return *this; \
</font>00077 <font class="preprocessor">  };
</font>00078 <font class="preprocessor"></font>
00079 MAKE_XV2VEC_OP_VAL(+=);
00080 MAKE_XV2VEC_OP_VAL(-=);
00081 MAKE_XV2VEC_OP_VAL(*=);
00082 MAKE_XV2VEC_OP_VAL(/=); 
00083 
00084   <font class="keyword">template</font> &lt;<font class="keyword">class </font>T2&gt;
00085   operator XV2Vec&lt;T2&gt; ()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T2&gt;((T2)(this-&gt;posx), (T2)(this-&gt;posy)); }
00086 };
00087 
00088 
00089 <font class="preprocessor">#define MAKE_COMPARE_OP_XVPOS_DIFF(OP) \
</font>00090 <font class="preprocessor">template &lt;class T1, class T2&gt;\
</font>00091 <font class="preprocessor">inline bool operator OP (const XV2Vec&lt;T1&gt; &amp; p1, const XV2Vec&lt;T2&gt; &amp; p2) { \
</font>00092 <font class="preprocessor">  return (p1.PosX() OP p2.PosX()) &amp;&amp; (p1.PosY() OP p2.PosY()); \
</font>00093 <font class="preprocessor">}; 
</font>00094 <font class="preprocessor"></font>
00095 MAKE_COMPARE_OP_XVPOS_DIFF(==);
00096 MAKE_COMPARE_OP_XVPOS_DIFF(!=);
00097 MAKE_COMPARE_OP_XVPOS_DIFF(&lt;=);
00098 MAKE_COMPARE_OP_XVPOS_DIFF(&gt;=);
00099 MAKE_COMPARE_OP_XVPOS_DIFF(&lt;);
00100 MAKE_COMPARE_OP_XVPOS_DIFF(&gt;);
00101 
00102 <font class="preprocessor">#define MAKE_COMPARE_OP_XVPOS(OP) \
</font>00103 <font class="preprocessor">template &lt;class T&gt;\
</font>00104 <font class="preprocessor">inline bool operator OP (const XV2Vec&lt;T&gt; &amp; p1, const XV2Vec&lt;T&gt; &amp; p2) { \
</font>00105 <font class="preprocessor">  return (p1.PosX() OP p2.PosX()) &amp;&amp; (p1.PosY() OP p2.PosY()); \
</font>00106 <font class="preprocessor">}; 
</font>00107 <font class="preprocessor"></font>
00108 MAKE_COMPARE_OP_XVPOS(==);
00109 MAKE_COMPARE_OP_XVPOS(!=);
00110 MAKE_COMPARE_OP_XVPOS(&lt;=);
00111 MAKE_COMPARE_OP_XVPOS(&gt;=);
00112 MAKE_COMPARE_OP_XVPOS(&lt;);
00113 MAKE_COMPARE_OP_XVPOS(&gt;);
00114 
00115 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00116 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; operator - (<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; p)<font class="keyword"></font>{ <font class="keywordflow">return</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt;(- p.PosX(), -p.PosY()); }
00117 
00122 <font class="preprocessor">#define MAKE_XVPOS_OP_XVPOS(OP) \
</font>00123 <font class="preprocessor">template &lt;class T1, class T2&gt;\
</font>00124 <font class="preprocessor">inline XV2Vec&lt;T1&gt; operator OP (const XV2Vec&lt;T1&gt; &amp; p1, const XV2Vec&lt;T2&gt; &amp; p2) { \
</font>00125 <font class="preprocessor">  return XV2Vec&lt;T1&gt;((T1)(p1.PosX() OP p2.PosX()), (T1)(p1.PosY() OP p2.PosY())); \
</font>00126 <font class="preprocessor">};
</font>00127 <font class="preprocessor"></font>
00128 MAKE_XVPOS_OP_XVPOS(+);
00129 MAKE_XVPOS_OP_XVPOS(-);
00130 
00135 <font class="preprocessor">#define MAKE_XVPOS_OP_VAL(OP) \
</font>00136 <font class="preprocessor">template &lt;class T&gt;\
</font>00137 <font class="preprocessor">inline XV2Vec&lt;T&gt; operator OP (const XV2Vec&lt;T&gt; &amp; p1,  T p2) { \
</font>00138 <font class="preprocessor">  return XV2Vec&lt;T&gt;((T)(p1.PosX() OP p2), (T)(p1.PosY() OP p2)); \
</font>00139 <font class="preprocessor">}; \
</font>00140 <font class="preprocessor">\
</font>00141 <font class="preprocessor">template &lt;class T&gt;\
</font>00142 <font class="preprocessor">inline XV2Vec&lt;T&gt; operator OP (T p2, const XV2Vec&lt;T&gt; &amp; p1) { \
</font>00143 <font class="preprocessor">  return XV2Vec&lt;T&gt;((T)(p2 OP p1.PosX()), (T)(p2 OP p1.PosY())); \
</font>00144 <font class="preprocessor">}; 
</font>00145 <font class="preprocessor"></font>
00146 MAKE_XVPOS_OP_VAL(+);
00147 MAKE_XVPOS_OP_VAL(-);
00148 MAKE_XVPOS_OP_VAL(*);
00149 MAKE_XVPOS_OP_VAL(/);
00150 
00151 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00152 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">int</font>&gt; round(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp;x)<font class="keyword"> </font>{
00153   <font class="keywordflow">return</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">int</font>&gt;(round(x.x()),round(x.y()));
00154 }
00155 
00156 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00157 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; rint(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp;x)<font class="keyword"> </font>{
00158   <font class="keywordflow">return</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt;(rint(x.x()),rint(x.y()));
00159 }
00160 
00161 <font class="comment">// dot product</font>
00162 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00163 T operator * (<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; t1, <font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; &amp; t2)<font class="keyword"></font>{
00164   <font class="keywordflow">return</font> t1.x() * t2.x() + t1.y() * t2.y();
00165 };
00166 
00167 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00168 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; mini(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; * arr, <font class="keyword">const</font> <font class="keywordtype">int</font> size)<font class="keyword"></font>{
00169 
00170   <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; minres = arr[0];
00171   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 1; i &lt; size; ++i){
00172     <font class="keywordflow">if</font>(minres.x() &gt; arr[i].x()) minres.setX(arr[i].x());
00173     <font class="keywordflow">if</font>(minres.y() &gt; arr[i].y()) minres.setY(arr[i].y());
00174   }
00175   <font class="keywordflow">return</font> minres;
00176 };
00177 
00178 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00179 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; maxi(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; * arr, <font class="keyword">const</font> <font class="keywordtype">int</font> size)<font class="keyword"></font>{
00180 
00181   <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; maxres = arr[0];
00182   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 1; i &lt; size; ++i){
00183     <font class="keywordflow">if</font>(maxres.x() &lt; arr[i].x()) maxres.setX(arr[i].x());
00184     <font class="keywordflow">if</font>(maxres.y() &lt; arr[i].y()) maxres.setY(arr[i].y());
00185   }
00186   <font class="keywordflow">return</font> maxres;
00187 };
00188 
00189 
00190 <font class="keyword">typedef</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; <a class="code" href="class_XV2Vec.html">XVPoint</a>;
00191 
<a name="l00193"></a><a class="code" href="class_XVLine.html">00193</a> <font class="keyword">class </font><a class="code" href="class_XVLine.html">XVLine</a> {
00194   
00195  <font class="keyword">public</font>:
00196 
00197   <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; center;
00198 
00199   <font class="keywordtype">double</font> length;
00200   <font class="keywordtype">double</font> angle;
00201   
00202   XVLine() : center(0, 0), length(0), angle(0)<font class="keyword"> </font>{}
00203   XVLine(<a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; end1, <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; end2);
00204 
00205   <font class="keywordtype">void</font> operator += (<a class="code" href="class_XVLine.html">XVLine</a>);
00206   <font class="keywordtype">void</font> operator -= (<a class="code" href="class_XVLine.html">XVLine</a>);
00207   
00208   <font class="keywordtype">void</font> endpoints (<a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; ends[2]) <font class="keyword">const</font>;
00209   <font class="keywordtype">void</font> rotate(<font class="keyword">const</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; &amp;, <font class="keywordtype">double</font>);
00210 };
00211 
00212 <a class="code" href="class_XVLine.html">XVLine</a> operator + (<a class="code" href="class_XVLine.html">XVLine</a>, <a class="code" href="class_XVLine.html">XVLine</a>);
00213 <a class="code" href="class_XVLine.html">XVLine</a> operator - (<a class="code" href="class_XVLine.html">XVLine</a>, <a class="code" href="class_XVLine.html">XVLine</a>);
00214 
00215 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; intersect(<font class="keyword">const</font> <a class="code" href="class_XVLine.html">XVLine</a> &amp;, <font class="keyword">const</font> <a class="code" href="class_XVLine.html">XVLine</a> &amp;);
00216 
00217 <font class="keyword">class </font>XVMatrix;
00218 
<a name="l00229"></a><a class="code" href="class_XVAffineMatrix.html">00229</a> <font class="keyword">class </font><a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> {
00230 
00231  <font class="keyword">public</font>:
00232 
00233   <font class="keywordtype">float</font> a;
00234   <font class="keywordtype">float</font> b;
00235   <font class="keywordtype">float</font> c;
00236   <font class="keywordtype">float</font> d;
00237 
00238   XVAffineMatrix(<font class="keywordtype">float</font> a0, <font class="keywordtype">float</font> b0, <font class="keywordtype">float</font> c0, <font class="keywordtype">float</font> d0) 
00239     : a(a0), b(b0), c(c0), d(d0)<font class="keyword"> </font>{}
00240   XVAffineMatrix() : a(0),b(0),c(0),d(0)<font class="keyword"> </font>{}
00241   XVAffineMatrix(<font class="keywordtype">double</font> angle);
00242   XVAffineMatrix(<font class="keywordtype">double</font> sx, <font class="keywordtype">double</font> sy)<font class="keyword"> </font>{
00243     a = sx;  d = sy; b = c = 0;
00244   };
00245   
00246   XVAffineMatrix(<font class="keywordtype">double</font> sh, <font class="keywordtype">double</font> d1, <font class="keywordtype">double</font> d2)<font class="keyword"></font>{
00247     a = d = 1;  c = 0; b = sh;
00248   };
00249 
00250   XVAffineMatrix(<font class="keyword">const</font> XVMatrix &amp;);
00251 
00252   operator XVMatrix();
00253   <font class="keywordtype">double</font> operator () (<font class="keywordtype">int</font> v);
00254   <font class="keywordtype">double</font> operator () (<font class="keywordtype">int</font> r, <font class="keywordtype">int</font> c);
00255   <font class="keywordtype">float</font>  det();
00256   <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> i();
00257   <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> t();
00258 };
00259 
00260 <font class="keyword">inline</font> <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> operator * (<font class="keyword">const</font> <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> &amp; m1, <font class="keyword">const</font> 
00261                       <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> &amp; m2)<font class="keyword"> 
</font>00262 <font class="keyword"></font>{
00263   <a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> res;  
00264   res.a = m1.a * m2.a + m1.b * m2.c;
00265   res.b = m1.a * m2.b + m1.b * m2.d;
00266   res.c = m1.c * m2.a + m1.d * m2.c;
00267   res.d = m1.c * m2.b + m1.d * m2.d;
00268   <font class="keywordflow">return</font> res;
00269 };
00270 
00271 <font class="keyword">typedef</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">float</font>&gt; <a class="code" href="class_XV2Vec.html">XVCoord2D</a>;
00272 
00273 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00274 <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; operator * (<a class="code" href="class_XVAffineMatrix.html">XVAffineMatrix</a> mat, <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt; vec)<font class="keyword"> </font>{
00275   <font class="keywordflow">return</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;T&gt;(mat.a * vec.x() + mat.b * vec.y(),
00276              mat.c * vec.x() + mat.d * vec.y());
00277 };
00278 
00279 <font class="keyword">inline</font> <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; intersect(<font class="keyword">const</font> <a class="code" href="class_XVLine.html">XVLine</a> &amp; lA, <font class="keyword">const</font> <a class="code" href="class_XVLine.html">XVLine</a> &amp; lB)<font class="keyword"> </font>{
00280 
00281   <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; endsA[2];
00282   lA.endpoints(endsA);
00283 
00284   <a class="code" href="class_XV2Vec.html">XV2Vec</a>&lt;<font class="keywordtype">double</font>&gt; endsB[2];
00285   lB.endpoints(endsB);
00286 
00287   <font class="keywordtype">double</font> lambda = 
00288     (((endsB[1].x() - endsB[0].x()) * 
00289       (endsA[0].y() - endsB[0].y()))
00290      - ((endsB[1].y() - endsB[0].y()) * 
00291      (endsA[0].x() - endsB[0].x()))) / 
00292     (((endsB[1].y() - endsB[0].y()) * 
00293       (endsA[1].x() - endsA[0].x()))
00294      - ((endsB[1].x() - endsB[0].x()) * 
00295      (endsA[1].y() - endsA[0].y())));
00296   
00297   <font class="keywordflow">return</font> endsA[0] + (lambda * (endsA[1] - endsA[0]));
00298 };
00299 
00300 <font class="preprocessor">#endif
</font></div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
