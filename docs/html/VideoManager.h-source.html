<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Devices/VideoManager.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Devices/VideoManager.h</h1><div class="fragment"><pre>00001 <font class="preprocessor">#ifndef __videomanag_h
</font>00002 <font class="preprocessor"></font><font class="preprocessor">#define __videomanag_h
</font>00003 <font class="preprocessor"></font>
00004 <font class="comment">/*                                                      -*-c++-*-
</font>00005 <font class="comment">    Copyright (C) 2000 Gregory D. Hager and Darius Burschka (JHU
</font>00006 <font class="comment">    Lab for Computational Interaction with Physical Systems (CIPS))
</font>00007 <font class="comment">
</font>00008 <font class="comment">Permission is granted to any individual or institution to use, copy,
</font>00009 <font class="comment">modify, and distribute this software, provided that this complete
</font>00010 <font class="comment">copyright and permission notice is maintained, intact, in all copies and
</font>00011 <font class="comment">supporting documentation.  Authors of papers that describe software
</font>00012 <font class="comment">systems using this software package are asked to acknowledge such use by
</font>00013 <font class="comment">a brief statement in the paper.
</font>00014 <font class="comment">
</font>00015 <font class="comment">We provide this software "as is" without express or implied warranty.
</font>00016 <font class="comment">
</font>00017 <font class="comment">*/</font>
00018 <font class="preprocessor">#ifdef HAVE_LIBPTHREAD
</font>00019 <font class="preprocessor"></font><font class="keyword">extern</font> <font class="stringliteral">"C"</font>{
00020 <font class="preprocessor">#include &lt;pthread.h&gt;</font>
00021 }
00022 <font class="preprocessor"># include &lt;deque&gt;</font>
00023 <font class="preprocessor">#include "XVVideo.h"</font>
00024 
00025 <font class="preprocessor">#define MAX_VIDMANG_MAP 10
</font>00026 <font class="preprocessor"></font><font class="preprocessor">#define MIN_BUFFERS     4
</font>00027 <font class="preprocessor"></font>
00028 <font class="keyword">template</font> &lt;<font class="keyword">class </font>XV_GRABBER&gt;
00029 <font class="keyword">class </font>VideoManager: <font class="keyword">public</font> XV_GRABBER
00030 {
00031   <font class="keyword">protected</font>:
00032   <font class="keyword">using</font> XV_GRABBER::n_buffers; 
00033 
00034   <font class="keyword">private</font>:
00035   <font class="keywordtype">int</font>             act_grabbed;
00036   <font class="keywordtype">int</font>            next_queued;
00037   <font class="keywordtype">int</font>            frame_number;
00038 
00039   <font class="comment">// handling of invalid buffers</font>
00040   deque   &lt;<font class="keywordtype">int</font>&gt;     free_buffer;
00041   deque   &lt;<font class="keywordtype">int</font>&gt;     ready_buffer;
00042 
00043   <font class="keywordtype">int</font>            *lock_count;      <font class="comment">// count of lock commands </font>
00044   <font class="keywordtype">int</font>            last_buffer;
00045   <font class="keywordtype">int</font>            buffer_map[MAX_VIDMANG_MAP];     <font class="comment">// mapping user and physical</font>
00046 
00047   <font class="comment">// pthread structures</font>
00048   pthread_t       grab_child;           <font class="comment">// reference to the acquis. thr.</font>
00049   <font class="comment">// messages about status changes in buffers</font>
00050   pthread_cond_t  free_message,frame_message;
00051   <font class="comment">// mutex for messages and for frame buffers</font>
00052   pthread_mutex_t free_flag,frame_flag;
00053  <font class="keyword">public</font>:
00054             VideoManager(<font class="keyword">const</font> <font class="keywordtype">char</font> *dev_name,
00055                            <font class="keyword">const</font> <font class="keywordtype">char</font> *parm_string=NULL);
00056             ~VideoManager(<font class="keywordtype">void</font>);
00057   <font class="keywordtype">int</font>            initiate_acquire(<font class="keywordtype">int</font> current);
00058   <font class="keywordtype">int</font>            wait_for_completion(<font class="keywordtype">int</font> buffer);
00059   <font class="keywordtype">int</font>            lock_buffer(<font class="keywordtype">int</font> buffer_number);
00060   <font class="keywordtype">int</font>            release_buffer(<font class="keywordtype">int</font>  buffer_number);
00061   <font class="keywordtype">void</font>              create_thread(<font class="keywordtype">void</font>);
00062   <font class="keywordtype">void</font>           *acquisition_task(<font class="keywordtype">void</font> *); <font class="comment">// for internal use</font>
00063 };
00064 
00065 <font class="preprocessor">#endif
</font>00066 <font class="preprocessor"></font><font class="preprocessor">#endif
</font></div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
