<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Consoles/XVRemoteWindowX.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Consoles/XVRemoteWindowX.h</h1><div class="fragment"><pre>00001 <font class="comment">// *** BEGIN_XVISION2_COPYRIGHT_NOTICE ***</font>
00002 <font class="comment">// *** END_XVISION2_COPYRIGHT_NOTICE ***</font>
00003 
00004 <font class="preprocessor">#ifndef _XVREMOTEWINDOWX_H_
</font>00005 <font class="preprocessor"></font><font class="preprocessor">#define _XVREMOTEWINDOWX_H_
</font>00006 <font class="preprocessor"></font>
00007 <font class="preprocessor">#include &lt;XVWindowX.h&gt;</font>
00008 <font class="preprocessor">#include &lt;pthread.h&gt;</font>
00009 <font class="preprocessor">#include &lt;list&gt;</font>
00010 <font class="preprocessor">#include &lt;queue&gt;</font>
00011 
00012 <font class="comment">// The following function is both on the manpage and in libpthread.a ,</font>
00013 <font class="comment">// but it is not in pthread.h , so I have to put the prototype here.</font>
00014 <font class="keyword">extern</font> <font class="stringliteral">"C"</font> 
00015 <font class="keywordtype">int</font> pthread_mutexattr_setkind_np( pthread_mutexattr_t *attr, <font class="keywordtype">int</font> kind );
00016 
00017 
<a name="l00030"></a><a class="code" href="class_XVRemoteWindowX.html">00030</a> <font class="keyword">template</font>&lt;<font class="keyword">class </font>T&gt;
00031 <font class="keyword">class </font><a class="code" href="class_XVRemoteWindowX.html">XVRemoteWindowX</a> : <font class="keyword">virtual</font> <font class="keyword">public</font> <a class="code" href="class_XVDrawWindow.html">XVDrawWindow</a>&lt;T&gt; {
00032  <font class="keyword">protected</font>:
00033   <font class="keyword">using</font> <a class="code" href="class_XVDrawWindow.html">XVDrawWindow</a>&lt;T&gt;::width ;
00034   <font class="keyword">using</font> <a class="code" href="class_XVDrawWindow.html">XVDrawWindow</a>&lt;T&gt;::height ;
00035   <font class="keyword">using</font> <a class="code" href="class_XVDrawWindow.html">XVDrawWindow</a>&lt;T&gt;::posx ;
00036   <font class="keyword">using</font> <a class="code" href="class_XVDrawWindow.html">XVDrawWindow</a>&lt;T&gt;::posy ;
00037 
00038  <font class="keyword">protected</font>:
00039   <font class="keyword">struct </font>Drawing {
00040     <font class="keyword">enum</font> Type { SwapBuffer, ClearWindow, DrawImage, 
00041           DrawPoint, DrawLine, DrawRectangle, 
00042           FillRectangle, DrawEllipse, FillEllipse, DrawString 
00043     } type ;
00044     <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> color ;
00045     <font class="keywordtype">int</font> x1, y1, x2, y2 ;
00046     <font class="keywordtype">char</font> *data ;
00047 
00048     Drawing( Type t, <font class="keyword">const</font> <a class="code" href="class_XVDrawColor.html">XVDrawColor</a>&amp; c ) : type(t), color(c), <a class="code" href="class_XVImageBase.html#a2">data</a>(0)<font class="keyword"> </font>{}
00049   };
00050   <font class="keyword">typedef</font> std::list&lt;Drawing&gt; Drawings ;
00051   <font class="keyword">typedef</font> <font class="keyword">typename</font> Drawings::iterator OneDrawing ;
00052 
00053   <font class="keyword">struct </font>Requests {
00054     <font class="keywordtype">bool</font> flush ;
00055     <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; image ;
00056     Drawings drawings ;
00057 
00058     Requests();
00059     ~Requests();
00060     <font class="keywordtype">void</font> clear(<font class="keywordtype">void</font>);
00061   } *next ;
00062 
00063   <font class="keyword">struct </font>Event {
00064     <font class="keyword">enum</font> { num_args = 2 };
00065     <font class="keywordtype">int</font> type, args[num_args] ;
00066   };
00067   <font class="keyword">typedef</font> std::queue&lt;Event&gt; Events ;
00068 
00069   <font class="keyword">struct </font>Data {
00070     <a class="code" href="class_XVDrawWindowX.html">XVDrawWindowX</a>&lt;T&gt;* worker ;
00071     pthread_mutex_t access_last, access_next ;
00072     Requests *last, *current, *next, *pre_last; 
00073     Events events ;
00074     <font class="keywordtype">bool</font> die ;              <font class="comment">// ending request</font>
00075     
00076     Data( <a class="code" href="class_XVDrawWindowX.html">XVDrawWindowX</a>&lt;T&gt;* w );
00077     ~Data();
00078 
00079     <font class="keywordtype">void</font> lock_last()<font class="keyword"> </font>{ pthread_mutex_lock( &amp;access_last ); }
00080     <font class="keywordtype">void</font> unlock_last()<font class="keyword"> </font>{ pthread_mutex_unlock( &amp;access_last ); }
00081     <font class="keywordtype">void</font> lock_next()<font class="keyword"> </font>{ pthread_mutex_lock( &amp;access_next ); }
00082     <font class="keywordtype">void</font> unlock_next()<font class="keyword"> </font>{ pthread_mutex_unlock( &amp;access_next ); }
00083   } * data ;
00084 
00085   <font class="keyword">static</font> <font class="keywordtype">void</font> * supervising( <font class="keywordtype">void</font> * obj );
00086 
00087   pthread_t supervisor ;
00088   <a class="code" href="class_XVDrawWindowX.html">XVDrawWindowX</a>&lt;T&gt; * worker ;
00089   <font class="keywordtype">bool</font> to_free ;
00090   <font class="keywordtype">bool</font> supervised ;
00091   <font class="keywordtype">float</font> factorX, factorY ;
00092 
00094   <font class="keywordtype">void</font> fetch_size(); 
00095 
00096  <font class="keyword">private</font>:
00097   <font class="keywordtype">void</font> init() ;
00098 
00099  <font class="keyword">public</font>:
00102   XVRemoteWindowX( <a class="code" href="class_XVDrawWindowX.html">XVDrawWindowX</a>&lt;T&gt;&amp; xwin, 
00103              <font class="keywordtype">float</font> scaleX = 1.0, <font class="keywordtype">float</font> scaleY = 1.0 );
00104   XVRemoteWindowX( <font class="keyword">const</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; &amp; im, 
00105              <font class="keywordtype">int</font> px = 0, <font class="keywordtype">int</font> py = 0, <font class="keywordtype">char</font> * title = NULL,
00106              <font class="keywordtype">int</font> event_mask = 0, <font class="keywordtype">char</font> * disp = NULL, 
00107              <font class="keywordtype">int</font> num_buf = 2, <font class="keywordtype">int</font> double_buf = 1, 
00108              <font class="keywordtype">int</font> function = GXcopy );
00109   XVRemoteWindowX( <font class="keyword">const</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; &amp; im, 
00110              <font class="keywordtype">float</font> scaleX, <font class="keywordtype">float</font> scaleY,
00111              <font class="keywordtype">int</font> px = 0, <font class="keywordtype">int</font> py = 0, <font class="keywordtype">char</font> * title = NULL,
00112              <font class="keywordtype">int</font> event_mask = 0, <font class="keywordtype">char</font> * disp = NULL, 
00113              <font class="keywordtype">int</font> num_buf = 2, <font class="keywordtype">int</font> double_buf = 1, 
00114              <font class="keywordtype">int</font> function = GXcopy );
00115   XVRemoteWindowX( <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h, 
00116              <font class="keywordtype">int</font> px = 0, <font class="keywordtype">int</font> py = 0, <font class="keywordtype">char</font> * title = NULL,
00117              <font class="keywordtype">int</font> event_mask = 0, <font class="keywordtype">char</font> * disp = NULL, 
00118              <font class="keywordtype">int</font> num_buf = 2, <font class="keywordtype">int</font> double_buf = 1, 
00119              <font class="keywordtype">int</font> function = GXcopy );
00120   XVRemoteWindowX( <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h, 
00121              <font class="keywordtype">float</font> scaleX, <font class="keywordtype">float</font> scaleY,
00122              <font class="keywordtype">int</font> px = 0, <font class="keywordtype">int</font> py = 0, <font class="keywordtype">char</font> * title = NULL,
00123              <font class="keywordtype">int</font> event_mask = 0, <font class="keywordtype">char</font> * disp = NULL, 
00124              <font class="keywordtype">int</font> num_buf = 2, <font class="keywordtype">int</font> double_buf = 1, 
00125              <font class="keywordtype">int</font> function = GXcopy );
00126 
00127   <font class="keyword">virtual</font> ~XVRemoteWindowX();
00128 
00129   <font class="keyword">virtual</font> <font class="keywordtype">void</font> map(<font class="keywordtype">void</font>)<font class="keyword"> </font>{ worker-&gt;map() ; }
00130   <font class="keyword">virtual</font> <font class="keywordtype">void</font> unmap(<font class="keywordtype">void</font>)<font class="keyword"> </font>{ worker-&gt;unmap(); }
00131 
<a name="l00132"></a><a class="code" href="class_XVRemoteWindowX.html#a9">00132</a>   <font class="keyword">virtual</font> <font class="keywordtype">void</font> setTitle( <font class="keyword">const</font> <font class="keywordtype">char</font>* title )<font class="keyword"> </font>{ worker-&gt;setTitle( title ); }
00133   <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="class_XVWindow.html#a4">resize</a>( <font class="keyword">const</font> <a class="code" href="class_XVSize.html">XVSize</a>&amp; size )<font class="keyword"> 
</font>00134 <font class="keyword">    </font>{ worker-&gt;resize(size); fetch_size(); }
00135 
00136   <font class="keyword">virtual</font> <font class="keywordtype">void</font> setImages( <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; * frames, <font class="keywordtype">int</font> count );
00137   <font class="keyword">virtual</font> <font class="keywordtype">void</font> CopyImage( <font class="keywordtype">int</font> which, u_short flip = 0 );
00138   <font class="keyword">virtual</font> <font class="keywordtype">void</font> ClearWindow(<font class="keywordtype">void</font>);
00139   <font class="keyword">virtual</font> <font class="keywordtype">void</font> CopySubImage( <font class="keyword">const</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt;&amp; image, <font class="keywordtype">bool</font> flip=0 );
00140 
00141   <font class="keyword">virtual</font> <font class="keywordtype">void</font> swap_buffers(<font class="keywordtype">void</font>);
00142   <font class="keyword">virtual</font> <font class="keywordtype">void</font> flush(<font class="keywordtype">void</font>);
00143 
00144   <font class="keyword">virtual</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; getDisplayedImage( <font class="keywordtype">int</font> px, <font class="keywordtype">int</font> py, <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h );
00145 
00148   <font class="keyword">virtual</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; getLastImage(<font class="keywordtype">void</font>);
00149 
00152   <font class="keyword">virtual</font> <a class="code" href="class_XVImageRGB.html">XVImageRGB</a>&lt;T&gt; getEventsImage(<font class="keywordtype">void</font>);
00153 
00154   <font class="keyword">virtual</font> <font class="keywordtype">int</font> check_events( <font class="keywordtype">int</font> *ret_filed );
00155 
00156   <font class="keyword">virtual</font> <font class="keywordtype">int</font> drawPoint( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00157   <font class="keyword">virtual</font> <font class="keywordtype">int</font> drawLine( <font class="keywordtype">int</font> x1, <font class="keywordtype">int</font> y1, <font class="keywordtype">int</font> x2, <font class="keywordtype">int</font> y2, 
00158                <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00159   <font class="keyword">virtual</font> <font class="keywordtype">int</font> drawRectangle( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h,
00160                     <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00161   <font class="keyword">virtual</font> <font class="keywordtype">int</font> fillRectangle( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h,
00162                     <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00163   <font class="keyword">virtual</font> <font class="keywordtype">int</font> drawEllipse( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h,
00164                   <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00165   <font class="keyword">virtual</font> <font class="keywordtype">int</font> fillEllipse( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h,
00166                   <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00167   <font class="keyword">virtual</font> <font class="keywordtype">int</font> drawString( <font class="keywordtype">int</font> x, <font class="keywordtype">int</font> y, <font class="keywordtype">char</font> * string, <font class="keywordtype">int</font> length,
00168                  <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c = DEFAULT_COLOR );
00169 
00170   <font class="keyword">virtual</font> <font class="keywordtype">void</font> addColor( <a class="code" href="class_XVDrawColor.html">XVDrawColor</a> c )<font class="keyword"> </font>{ worker-&gt;addColor(c); }
00171   <font class="keyword">virtual</font> <font class="keywordtype">void</font> setXOR()<font class="keyword"> </font>{ worker-&gt;setXOR(); }
00172   <font class="keyword">virtual</font> <font class="keywordtype">void</font> setCOPY()<font class="keyword"> </font>{ worker-&gt;setCOPY(); }
00173 
00177   <font class="keyword">virtual</font> Display * getXDisplay(<font class="keywordtype">void</font>)<font class="keyword"> </font>{ <font class="keywordflow">return</font> worker-&gt;getXDisplay(); }
00178   <font class="keyword">virtual</font> Drawable getXDrawable(<font class="keywordtype">void</font>)<font class="keyword"> </font>{ <font class="keywordflow">return</font> worker-&gt;getXDrawable(); }  
00179 
00180   <font class="comment">// Due to the bad design of XVWindow (deriving from XVImageBase),</font>
00181   <font class="comment">// member functions of XVSize, etc has to be overridden here.</font>
00182   <font class="comment">// This won't work if base class pointer/reference is used, so</font>
00183   <font class="comment">// fetch_size() is used as a backup</font>
00184   <font class="keywordtype">int</font> Width()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;Width(); }
00185   <font class="keywordtype">int</font> Height()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;Height(); }
00186   <font class="keywordtype">int</font> Rows()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;Rows(); }
00187   <font class="keywordtype">int</font> Columns()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;Columns(); }
00188   <font class="keyword">const</font> <font class="keywordtype">int</font>&amp; PosX()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;PosX(); }
00189   <font class="keyword">const</font> <font class="keywordtype">int</font>&amp; PosY()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;PosY(); }
00190   <font class="keyword">const</font> <font class="keywordtype">int</font>&amp; x()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;x(); }
00191   <font class="keyword">const</font> <font class="keywordtype">int</font>&amp; y()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> worker-&gt;y(); }
00192   <font class="comment">// the list above is far from complete, and please add entries if used</font>
00193 };
00194 
00195 <font class="preprocessor">#endif //_XVREMOTEWINDOWX_H_
</font>00196 <font class="preprocessor"></font>
</div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
