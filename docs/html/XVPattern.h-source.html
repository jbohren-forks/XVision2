<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Tracking/Edges/XVPattern.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Tracking/Edges/XVPattern.h</h1><div class="fragment"><pre>00001 <font class="comment">// *** BEGIN_XVISION2_COPYRIGHT_NOTICE ***</font>
00002 <font class="comment">// *** END_XVISION2_COPYRIGHT_NOTICE ***</font>
00003 
00014 <font class="preprocessor">#ifndef _XVPATTERN_H_
</font>00015 <font class="preprocessor"></font><font class="preprocessor">#define _XVPATTERN_H_
</font>00016 <font class="preprocessor"></font>
00017 <font class="preprocessor">#define TINY  0.001
</font>00018 <font class="preprocessor"></font>
00019 <font class="preprocessor">#include &lt;XVTools.h&gt;</font>
00020 <font class="preprocessor">#include &lt;XVImageScalar.h&gt;</font>
00021 <font class="preprocessor">#include &lt;XVFeature.h&gt;</font>
00022 
00023 <font class="comment">//-----------------------------------------------------------------------------</font>
00024 <font class="comment">//  Default parameters</font>
00025 <font class="comment">//-----------------------------------------------------------------------------</font>
00026 
00027 <font class="keywordtype">int</font>   <font class="keyword">const</font> default_mwidth = 8;
00028 <font class="keywordtype">float</font> <font class="keyword">const</font> default_alpha  = deg_rad (15);
00029 <font class="keywordtype">int</font>   <font class="keyword">const</font> default_edge_threshold = 5;
00030 <font class="keywordtype">int</font>   <font class="keyword">const</font> default_width = 40;
00031 <font class="keywordtype">float</font> <font class="keyword">const</font> default_sensitivity = 1.0;
00032 <font class="keywordtype">int</font>   <font class="keyword">const</font> default_prewitt_width = 2;
00033 
00034 <font class="comment">//-----------------------------------------------------------------------------</font>
00035 <font class="comment">//  Structures for return values</font>
00036 <font class="comment">//-----------------------------------------------------------------------------</font>
00037 
00038 <font class="keyword">typedef</font> <font class="keyword">struct </font>{
00039   <font class="keywordtype">double</font> x, angle, val;
00040 } XVOffset;
00041 
00042 <font class="keyword">typedef</font> <font class="keyword">struct </font>{                        <font class="comment">// returned by interpolation</font>
00043   <font class="keywordtype">float</font> x, val;
00044 } XVPeak;
00045 
00046 <font class="comment">//----------------------------------------------------------------------------</font>
00047 <font class="comment">//  Definitions of XVEdge templates</font>
00048 <font class="comment">//----------------------------------------------------------------------------</font>
00049 
00050 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font><a class="code" href="class_XVPattern.html">XVPattern</a>;
00051 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font><a class="code" href="class_XVEdge.html">XVEdge</a>;
00052 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font>XVAbsMEdge;
00053 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font><a class="code" href="class_XVMaxEdge.html">XVMaxEdge</a>;
00054 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font>XVGeneralEdge;
00055 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font>XVGaussEdge;
00056 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt; <font class="keyword">class </font><a class="code" href="class_XVShortEdge.html">XVShortEdge</a>;
00057 
00058 <font class="preprocessor">#include &lt;XVException.h&gt;</font>
00059 
00060 <font class="keyword">class </font>XVEdgeException : <font class="keyword">public</font> <a class="code" href="class_XVException.html">XVException</a> {
00061 
00062  <font class="keyword">public</font>:
00063 
00064   XVEdgeException() : <a class="code" href="class_XVException.html">XVException</a>() {}
00065   XVEdgeException(<font class="keywordtype">char</font> * str) : <a class="code" href="class_XVException.html">XVException</a>(str) {}
00066 };
00067 
00082 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
<a name="l00083"></a><a class="code" href="class_XVPattern.html">00083</a> <font class="keyword">class </font><a class="code" href="class_XVPattern.html">XVPattern</a> {
00084 
00085 <font class="keyword">protected</font>:
00086 
00087   <font class="comment">// Edge thresholds are defined by the expected difference in the</font>
00088   <font class="comment">// light/dark transition.  The actual threshold is computed</font>
00089   <font class="comment">// based on the size of the window and the size of the mask;</font>
00090   <font class="keywordtype">int</font> lthreshold, uthreshold;
00091   <font class="keywordtype">float</font> _sensitivity;
00092   <font class="keywordtype">int</font> mwidth;
00093 
00094 <font class="keyword">public</font>:
00095 
00096   <font class="keyword">typedef</font> T PIXELTYPE;
00097 
00098   XVPattern()<font class="keyword"></font>{};
00099   XVPattern(<font class="keyword">const</font> <a class="code" href="class_XVPattern.html">XVPattern</a> &amp; cpy) : lthreshold(cpy.lthreshold),
00100                                      uthreshold(cpy.uthreshold),
00101                                      _sensitivity(cpy._sensitivity),
00102                                      mwidth(cpy.mwidth)<font class="keyword"> </font>{}
00103   
00104  
00105   <font class="keyword">virtual</font> <font class="keywordtype">int</font> xpad (<font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height) = 0;
00106   <font class="keyword">virtual</font> <font class="keywordtype">int</font> ypad (<font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height) = 0;
00107 
00108   <font class="keyword">virtual</font> XVOffset find (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp;) = 0;
00109 
00110   <font class="keywordtype">float</font> sensitivity()<font class="keyword"> </font>{ <font class="keywordflow">return</font> _sensitivity; };
00111   <font class="keywordtype">void</font> set_sensitivity(<font class="keywordtype">float</font> sen)<font class="keyword"> </font>{ _sensitivity =sen; };
00112 
00113   <font class="keywordtype">int</font> lower_threshold(<font class="keywordtype">int</font> image_height)<font class="keyword"> </font>{
00114     <font class="keywordflow">return</font> (mwidth/2) * image_height * lthreshold;
00115   }
00116 
00117   <font class="keywordtype">int</font> upper_threshold(<font class="keywordtype">int</font> image_height)<font class="keyword"> </font>{
00118     <font class="keywordflow">return</font> (mwidth/2) * image_height * uthreshold;
00119   }
00120 };
00121 
00122 <font class="keyword">typedef</font> <font class="keyword">enum</font> {none, lightdark, darklight, any} linetype;
00123 
00128 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
<a name="l00129"></a><a class="code" href="class_XVEdge.html">00129</a> <font class="keyword">class </font><a class="code" href="class_XVEdge.html">XVEdge</a> : <font class="keyword">public</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt; {
00130  <font class="keyword">protected</font>:
00131   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::lthreshold ;
00132   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::uthreshold ;
00133   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::_sensitivity ;
00134   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::mwidth ;
00135 
00136  <font class="keyword">private</font>:
00137   <font class="keywordtype">float</font> alpha;
00138 
00139   <font class="comment">// By convention, a line is named by the brightness change when</font>
00140   <font class="comment">// facing the the direction of the line.  By default, a line</font>
00141   <font class="comment">// is unsigned.  By setting the transition type to "any,"</font>
00142   <font class="comment">// the line starts unsigned and changes once it locks on.</font>
00143   linetype trans_type;
00144 
00145 <font class="keyword">public</font>:
00146 
00147   XVEdge (<font class="keywordtype">int</font> mwidth_in = default_mwidth, <font class="keywordtype">float</font> alpha_in = default_alpha)<font class="keyword"> </font>{
00148     mwidth = mwidth_in; alpha = alpha_in; trans_type = any;
00149     <font class="keywordflow">if</font> (odd (mwidth)) mwidth++;              <font class="comment">// the algorithm only makes sense</font>
00150                                              <font class="comment">// for even mask widths</font>
00151     lthreshold = default_edge_threshold;
00152     uthreshold = 256;
00153     _sensitivity = default_sensitivity;
00154   };
00155   
00156   XVEdge (<font class="keyword">const</font> <a class="code" href="class_XVEdge.html">XVEdge</a> &amp; e)<font class="keyword"> </font>{*<font class="keyword">this</font> = e;};
00157   
00158   <font class="keyword">virtual</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt; *dup()<font class="keyword"> </font>{<font class="keywordflow">return</font> <font class="keyword">new</font> XVEdge(*<font class="keyword">this</font>);};
00159   
00160   <font class="keywordtype">int</font> xpad (<font class="keywordtype">int</font> , <font class="keywordtype">int</font> height)<font class="keyword">
</font>00161 <font class="keyword">    </font>{ <font class="keywordflow">return</font> mwidth-1 + 2 * round (half (height) * tan (alpha)); }
00162   <font class="keywordtype">int</font> ypad (<font class="keywordtype">int</font> , <font class="keywordtype">int</font> )<font class="keyword"> </font>{ <font class="keywordflow">return</font> 0; }
00163   
00164   XVOffset find (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp;);
00165   
00166   linetype &amp; lineType()<font class="keyword"> </font>{ <font class="keywordflow">return</font> trans_type; }
00167 };
00168 
00173 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
<a name="l00174"></a><a class="code" href="class_XVMaxEdge.html">00174</a> <font class="keyword">class </font><a class="code" href="class_XVMaxEdge.html">XVMaxEdge</a> : <font class="keyword">public</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt; {
00175   
00176   <font class="comment">// By convention, a line is named by the brightness change when</font>
00177   <font class="comment">// facing the the direction of the line.  By default, a line</font>
00178   <font class="comment">// is unsigned.  By setting the transition type to "any,"</font>
00179   <font class="comment">// the line starts unsigned and changes once it locks on.</font>
00180  <font class="keyword">protected</font>:
00181   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::lthreshold ;
00182   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::uthreshold ;
00183   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::_sensitivity ;
00184   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::mwidth ;
00185 
00186  <font class="keyword">private</font>:  
00187   linetype trans_type;
00188   
00189  <font class="keyword">public</font>:
00190   XVMaxEdge (<font class="keywordtype">int</font> mwidth_in = default_mwidth, <font class="keywordtype">int</font> min_threshold = 0)<font class="keyword"> </font>{
00191     mwidth = mwidth_in; trans_type = any;
00192     <font class="keywordflow">if</font> (odd (mwidth)) mwidth++;              <font class="comment">// the algorithm only makes sense</font>
00193     <font class="comment">// for even mask widths</font>
00194     lthreshold = min_threshold;
00195     _sensitivity = default_sensitivity;
00196   }
00197   
00198   XVMaxEdge (<font class="keyword">const</font> <a class="code" href="class_XVMaxEdge.html">XVMaxEdge</a> &amp; e)<font class="keyword"> </font>{*<font class="keyword">this</font> = e;};
00199   
00200   <font class="keywordtype">int</font> xpad (<font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h)<font class="keyword">  </font>{ <font class="keywordflow">return</font> w-1; }
00201   <font class="keywordtype">int</font> ypad (<font class="keywordtype">int</font> w, <font class="keywordtype">int</font> h)<font class="keyword"> </font>{ <font class="keywordflow">return</font> 0; }
00202   XVOffset find (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp;);
00203 
00204   linetype &amp; lineType()<font class="keyword"> </font>{ <font class="keywordflow">return</font> trans_type; }
00205 };
00206 
00207 
00208 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
00209 <font class="keyword">class </font>XVGeneralEdge : <font class="keyword">public</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt; {
00210 <font class="keyword">protected</font>:
00211   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::lthreshold ;
00212   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::uthreshold ;
00213   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::_sensitivity ;
00214   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::mwidth ;
00215 
00216 <font class="keyword">protected</font>:
00217   <font class="keywordtype">int</font> *mask;
00218   <font class="keywordtype">float</font> alpha;                     <font class="comment">// angle offset at which to check</font>
00219                               <font class="comment">// for tilted line</font>
00220   <font class="keywordtype">float</font> maxdiffangle;                   <font class="comment">// maximum amount of angle offset</font>
00221   <font class="comment">//  int lower_threshold,upper_threshold;</font>
00222 
00223   linetype trans_type;
00224 
00225 <font class="keyword">public</font>:
00226   XVGeneralEdge (<font class="keywordtype">int</font> mwidth_in = default_mwidth, linetype trans_type_in = any,
00227             <font class="keywordtype">float</font> alpha_in = default_alpha);
00228 
00229   XVGeneralEdge (<font class="keywordtype">int</font> * mask_in, <font class="keywordtype">int</font> mwidth_in = default_mwidth, 
00230            linetype trans_type_in = any,
00231            <font class="keywordtype">float</font> alpha_in = default_alpha);
00232 
00233   XVGeneralEdge (<font class="keyword">const</font> XVGeneralEdge &amp;);
00234   ~XVGeneralEdge()<font class="keyword"> </font>{ <font class="keyword">delete</font> mask; }
00235 
00236   <font class="keywordtype">int</font> xpad (<font class="keywordtype">int</font> mwidth_in, <font class="keywordtype">int</font> height)<font class="keyword">
</font>00237 <font class="keyword">    </font>{ <font class="keywordflow">return</font> mwidth_in-1 + 2 * round (half (height) * tan (alpha)); }
00238   <font class="keywordtype">int</font> ypad (<font class="keywordtype">int</font> , <font class="keywordtype">int</font>)<font class="keyword"> </font>{ <font class="keywordflow">return</font> 0; }
00239   XVOffset find (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp;);
00240 
00241   linetype &amp; lineType()<font class="keyword"> </font>{ <font class="keywordflow">return</font> trans_type; }
00242 };
00243 
00249 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T&gt;
<a name="l00250"></a><a class="code" href="class_XVShortEdge.html">00250</a> <font class="keyword">class </font><a class="code" href="class_XVShortEdge.html">XVShortEdge</a> : <font class="keyword">public</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt; {
00251 
00252   <font class="comment">// XVShortEdges are Edges of length 1, so no angle is required.</font>
00253 <font class="keyword">protected</font>:
00254   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::lthreshold ;
00255   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::uthreshold ;
00256   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::_sensitivity ;
00257   <font class="keyword">using</font> <a class="code" href="class_XVPattern.html">XVPattern</a>&lt;T&gt;::mwidth ;
00258 
00259 <font class="keyword">private</font>:
00260   <font class="keywordtype">int</font> maxpeaks;                              <font class="comment">// half of image width</font>
00261 
00262 <font class="keyword">public</font>:
00263   XVShortEdge (<font class="keywordtype">int</font> mwidth_in = default_mwidth);
00264 
00265   XVShortEdge (<font class="keyword">const</font> <a class="code" href="class_XVShortEdge.html">XVShortEdge</a> &amp; s)<font class="keyword"> </font>{*<font class="keyword">this</font> = s;};
00266 
00267   <font class="keywordtype">int</font> xpad (<font class="keywordtype">int</font> , <font class="keywordtype">int</font> )<font class="keyword">
</font>00268 <font class="keyword">    </font>{ <font class="keywordflow">return</font> mwidth-1 + 2; }
00269   <font class="keywordtype">int</font> ypad (<font class="keywordtype">int</font> , <font class="keywordtype">int</font> )<font class="keyword"> </font>{ <font class="keywordflow">return</font> 0; }
00270 
00271   <font class="comment">// This just returns the offset of the strongest peak.</font>
00272   XVOffset find (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp; im);
00273 
00274   <font class="comment">// This fills  lowout  with relevant info.  An upscale find fcn.</font>
00275   <font class="keywordtype">void</font> getlowout_ct (<a class="code" href="class_XVImageScalar.html">XVImageScalar</a>&lt;T&gt; &amp; im); <font class="comment">// , SE_out &amp; lowout);</font>
00276 };
00277 
00278 <font class="preprocessor">#include &lt;XVPattern.icc&gt;</font>
00279 
00280 <font class="preprocessor">#endif
</font></div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
