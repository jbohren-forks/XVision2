<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Tools/XVLookupTable.icc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Tools/XVLookupTable.icc</h1><div class="fragment"><pre>00001 <font class="comment">// *** BEGIN_XVISION2_COPYRIGHT_NOTICE ***</font>
00002 <font class="comment">// *** END_XVISION2_COPYRIGHT_NOTICE ***</font>
00003 
00004 <font class="preprocessor">#ifndef _XVLOOKUPTABLE_ICC_
</font>00005 <font class="preprocessor"></font><font class="preprocessor">#define _XVLOOKUPTABLE_ICC_
</font>00006 <font class="preprocessor"></font>
00007 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
<a name="l00008"></a><a class="code" href="class_XVScalarTable.html#a1">00008</a> <font class="keywordtype">void</font> <a class="code" href="class_XVScalarTable.html#a1">XVScalarTable&lt;T, Y&gt;::buildTable</a>()<font class="keyword"></font>{
00009 
00010   T max = (T)USHRT_MAX;
00011   table = <font class="keyword">new</font> Y[max + 1];
00012   
00013   T pixel;
00014   
00015   <font class="keywordflow">for</font>(pixel = 0; pixel &lt;= max; pixel++){
00016     
00017     table[pixel] = computeValue(pixel);
00018     <font class="keywordflow">if</font>(pixel == max) <font class="keywordflow">break</font>;
00019   }
00020 };
00021  
00022 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00023 <font class="keywordtype">void</font> XVRGBTable&lt;T, Y&gt;::buildTable()<font class="keyword"></font>{
00024   
00025   T max = {255, 255, 255};
00026   <font class="keywordtype">int</font> num_bits;
00027   
00028   <font class="keywordflow">switch</font>(max.g){
00029     
00030   <font class="keywordflow">case</font> 31:      
00031     num_bits = 15;
00032     <font class="keywordflow">break</font>;
00033   <font class="keywordflow">case</font> 63:
00034     num_bits = 16;
00035     <font class="keywordflow">break</font>;
00036   <font class="keywordflow">case</font> 255:
00037     num_bits = 16;
00038   }
00039   
00040   <font class="keyword">delete</font>[] table;
00041   table = <font class="keyword">new</font> Y[1 &lt;&lt; num_bits];
00042   
00043   T pixel;
00044   
00045   <font class="keywordtype">int</font> add = 1, addG = 1;
00046   <font class="keywordflow">if</font>(max.r &gt; 31){
00047     add = 8;
00048     addG = 4;
00049     max.r = 248;
00050     max.g = 252;
00051     max.b = 248;
00052   }
00053   pixel.r = pixel.b = pixel.g = 0;
00054   <font class="comment">// create lookup-table</font>
00055   <font class="keywordflow">for</font>(pixel.r = 0; pixel.r &lt;= max.r; pixel.r += add){
00056     <font class="keywordflow">for</font>(pixel.g = 0; pixel.g &lt;= max.g; pixel.g += addG){
00057       <font class="keywordflow">for</font>(pixel.b = 0; pixel.b &lt;= max.b; pixel.b += add){
00058      this-&gt;tableElement(pixel) = this-&gt;computeValue(pixel);
00059      <font class="keywordflow">if</font>(pixel.b == max.b) <font class="keywordflow">break</font>;
00060       }
00061       <font class="keywordflow">if</font>(pixel.g == max.g) <font class="keywordflow">break</font>;
00062     }
00063     <font class="keywordflow">if</font>(pixel.r == max.r) <font class="keywordflow">break</font>;
00064   }
00065 };
00066 
00067 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00068 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator [] (<font class="keyword">const</font> XV_RGB15 pixel)<font class="keyword"></font>{
00069   <font class="keywordflow">return</font> table[*((u_short *) &amp; pixel)];
00070 };
00071 
00072 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00073 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator () (<font class="keyword">const</font> XV_RGB15 pixel)<font class="keyword"></font>{
00074   <font class="keywordflow">return</font> table[*((u_short *) &amp; pixel)];
00075 };
00076   
00077 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00078 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator [] (<font class="keyword">const</font> XV_RGB16 pixel)<font class="keyword"></font>{
00079   <font class="keywordflow">return</font> table[*((u_short *) &amp; pixel)];
00080 };
00081 
00082 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00083 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator () (<font class="keyword">const</font> XV_RGB16 pixel)<font class="keyword"></font>{
00084   <font class="keywordflow">return</font> table[*((u_short *) &amp; pixel)];
00085 };
00086 
00087 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;  
00088 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator [] (<font class="keyword">const</font> XV_RGB24 pixel)<font class="keyword"></font>{  
00089   <font class="keywordflow">return</font> table[((pixel.r &amp; 0xf8) &lt;&lt; 8) | ((pixel.g &amp; 0xfc) &lt;&lt; 3) | (pixel.b &gt;&gt; 3)];
00090 };
00091 
00092 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;  
00093 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator () (<font class="keyword">const</font> XV_RGB24 pixel)<font class="keyword"></font>{  
00094   <font class="keywordflow">return</font> table[((pixel.r &amp; 0xf8) &lt;&lt; 8) | ((pixel.g &amp; 0xfc) &lt;&lt; 3) | (pixel.b &gt;&gt; 3)];
00095 };
00096    
00097 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00098 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator [] (<font class="keyword">const</font> XV_RGBA32 pixel)<font class="keyword"></font>{
00099   <font class="keywordflow">return</font> table[((pixel.r &amp; 0xf8) &lt;&lt; 8) | ((pixel.g &amp; 0xfc) &lt;&lt; 3) | (pixel.b &gt;&gt; 3)];
00100 };
00101 
00102 <font class="keyword">template</font> &lt;<font class="keyword">class </font>T, <font class="keyword">class </font>Y&gt;
00103 <font class="keyword">inline</font> Y XVRGBTable&lt;T, Y&gt;::operator () (<font class="keyword">const</font> XV_RGBA32 pixel)<font class="keyword"></font>{
00104   <font class="keywordflow">return</font> table[((pixel.r &amp; 0xf8) &lt;&lt; 8) | ((pixel.g &amp; 0xfc) &lt;&lt; 3) | (pixel.b &gt;&gt; 3)];
00105 };
00106 
00107 <font class="keyword">template</font> &lt;<font class="keyword">class </font>YUV_TYPE, <font class="keyword">class </font>TO_TYPE&gt;
00108 <font class="keywordtype">void</font> XVYUVTable&lt;YUV_TYPE, TO_TYPE&gt;::buildTable()<font class="keyword"></font>{
00109 
00110   <font class="keyword">delete</font>[] table;
00111 
00112   table = <font class="keyword">new</font> TO_TYPE[1 &lt;&lt; 16];
00113   <font class="keywordtype">int</font> max = 255;
00114 
00115   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> y = 0; y &lt; max; ++y){
00116     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> u = 0; u &lt; max; ++u){
00117       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> v = 0; v &lt; max; ++v){
00118      
00119      XV_YUV24 val = {y, u, v};
00120      this-&gt;tableElement(val) = this-&gt;computeValue(val);
00121       }
00122     }
00123   }
00124 };
00125 
00126 <font class="keyword">template</font> &lt;<font class="keyword">class </font>YUV_TYPE, <font class="keyword">class </font>TO_TYPE&gt;
00127 TO_TYPE XVYUVTable&lt;YUV_TYPE, TO_TYPE&gt;::operator [] (<font class="keyword">const</font> XV_YUV24 pixel)<font class="keyword"></font>{
00128 
00129   <font class="keywordflow">return</font> table[((pixel.y &lt;&lt; 8) | (pixel.u &lt;&lt; 4) | pixel.v)];
00130 };
00131 
00132 <font class="keyword">template</font> &lt;<font class="keyword">class </font>YUV_TYPE, <font class="keyword">class </font>TO_TYPE&gt;
00133 TO_TYPE XVYUVTable&lt;YUV_TYPE, TO_TYPE&gt;::operator () (<font class="keyword">const</font> XV_YUV24 pixel)<font class="keyword"></font>{
00134 
00135   <font class="keywordflow">return</font> table[((pixel.y &lt;&lt; 8) | (pixel.u &lt;&lt; 4) | pixel.v)];
00136 };
00137 
00138 <font class="preprocessor">#endif
</font></div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
