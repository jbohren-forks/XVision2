<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/burschka/XVision2-2.0.0/src/Devices/svs.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.0 on Fri Oct 26 00:17:16 2007 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>/home/burschka/XVision2-2.0.0/src/Devices/svs.h</h1><div class="fragment"><pre>00001 <font class="comment">/*#########################################
</font>00002 <font class="comment"> * svs.h
</font>00003 <font class="comment"> *
</font>00004 <font class="comment"> * Header file for the SVM library
</font>00005 <font class="comment"> *
</font>00006 <font class="comment"> *#########################################
</font>00007 <font class="comment"> */</font>
00008 
00009 <font class="preprocessor">#ifndef _svs_h_
</font>00010 <font class="preprocessor"></font><font class="preprocessor">#define _svs_h_
</font>00011 <font class="preprocessor"></font>
00042 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00043 
00044 <font class="preprocessor">#ifdef UNIX
</font>00045 <font class="preprocessor"></font><font class="preprocessor">#include &lt;sys/ipc.h&gt;</font>
00046 <font class="preprocessor">#include &lt;sys/shm.h&gt;</font>
00047 <font class="preprocessor">#include &lt;string.h&gt;</font>
00048 <font class="preprocessor">#define ALIGN8 __attribute__ ((aligned (8)))
</font>00049 <font class="preprocessor"></font><font class="preprocessor">#define ALIGN16 __attribute__ ((aligned (16)))
</font>00050 <font class="preprocessor"></font><font class="preprocessor">#define WINALIGN8
</font>00051 <font class="preprocessor"></font><font class="preprocessor">#define WINALIGN16
</font>00052 <font class="preprocessor"></font><font class="preprocessor">#define FALSE 0
</font>00053 <font class="preprocessor"></font><font class="preprocessor">#define TRUE 1
</font>00054 <font class="preprocessor"></font><font class="preprocessor">#endif
</font>00055 <font class="preprocessor"></font>
00056 <font class="preprocessor">#ifdef WIN32
</font>00057 <font class="preprocessor"></font><font class="preprocessor">#include &lt;windows.h&gt;</font>
00058 <font class="preprocessor">#define ALIGN8
</font>00059 <font class="preprocessor"></font><font class="preprocessor">#define ALIGN16
</font>00060 <font class="preprocessor"></font><font class="preprocessor">#define WINALIGN8 __declspec(align(8))
</font>00061 <font class="preprocessor"></font><font class="preprocessor">#define WINALIGN16 __declspec(align(16))
</font>00062 <font class="preprocessor"></font><font class="preprocessor">#ifdef CALCLIB
</font>00063 <font class="preprocessor"></font><font class="preprocessor">#define REALLYIMPORT __declspec(dllimport)
</font>00064 <font class="preprocessor"></font><font class="preprocessor">#else
</font>00065 <font class="preprocessor"></font><font class="preprocessor">#define REALLYIMPORT IMPORT
</font>00066 <font class="preprocessor"></font><font class="preprocessor">#endif
</font>00067 <font class="preprocessor"></font><font class="preprocessor">#ifndef LIBCODE
</font>00068 <font class="preprocessor"></font><font class="preprocessor">#define IMPORT __declspec(dllimport)
</font>00069 <font class="preprocessor"></font><font class="preprocessor">#else
</font>00070 <font class="preprocessor"></font><font class="preprocessor">#define IMPORT __declspec(dllexport)
</font>00071 <font class="preprocessor"></font><font class="preprocessor">#endif
</font>00072 <font class="preprocessor"></font><font class="preprocessor">#else
</font>00073 <font class="preprocessor"></font><font class="preprocessor">#define IMPORT
</font>00074 <font class="preprocessor"></font><font class="preprocessor">#define REALLYIMPORT
</font>00075 <font class="preprocessor"></font><font class="preprocessor">#endif
</font>00076 <font class="preprocessor"></font>
00077 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> UCHTYPE16 ;
00078 <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">short</font> USHTYPE16 ;
00079 <font class="keyword">typedef</font> <font class="keywordtype">signed</font> <font class="keywordtype">short</font> SHTYPE16 ;
00080 
00081 <font class="comment">/* This structure stores the intrinsic parameters of a camera.  The 
</font>00082 <font class="comment"> *   first half of this structure deals with parameters recovered
</font>00083 <font class="comment"> *   from camera calibration.  The second half allows for the 
</font>00084 <font class="comment"> *   parameters to be adjusted for subsampled images and subwindows.
</font>00085 <font class="comment"> *   Camera calibration should be done for the largest image size 
</font>00086 <font class="comment"> *   possible, and the image subwindow parameters used if smaller 
</font>00087 <font class="comment"> *   images are to be used.
</font>00088 <font class="comment"> */</font>
00089 <font class="keyword">typedef</font> <font class="keyword">struct </font>{
00090   <font class="comment">/* Intrinsic parameters */</font>
00091   <font class="keywordtype">int</font>       pwidth;             <font class="comment">/* [pix]    Width of rectification images */</font>
00092   <font class="keywordtype">int</font>       pheight;            <font class="comment">/* [pix]    Height of rectification images */</font>
00093   <font class="keywordtype">double</font>    dpx;                <font class="comment">/* [mm/pix] X dimension of pixel in frame grabber */</font>
00094   <font class="keywordtype">double</font>    dpy;                <font class="comment">/* [mm/pix] Y dimension of pixel in frame grabber */</font>
00095   <font class="keywordtype">double</font>    sx;                 <font class="comment">/* []       Scale factor to compensate for any error in dpx   */</font>
00096   <font class="keywordtype">double</font>    Cx;                 <font class="comment">/* [pix]    Z axis intercept of image plane */</font>
00097   <font class="keywordtype">double</font>    Cy;                 <font class="comment">/* [pix]    Z axis intercept of image plane */</font>
00098   <font class="keywordtype">double</font>    f, fy;              <font class="comment">/* [mm]     Focal length */</font>
00099   <font class="keywordtype">double</font>    alpha;              <font class="comment">/* skew, usually zero */</font>
00100   <font class="keywordtype">double</font>    kappa1;             <font class="comment">/* [1/mm^2] First coefficient of radial distortion */</font>
00101   <font class="keywordtype">double</font>    kappa2;             <font class="comment">/* [1/mm^4] Second coefficient of radial distortion */</font>
00102   <font class="keywordtype">double</font>    kappa3;             <font class="comment">/* [1/mm^6] Second coefficient of radial distortion */</font>
00103   <font class="keywordtype">double</font>    tau1, tau2;         <font class="comment">/* tangential distortion, normalized */</font>
00104   <font class="keywordtype">float</font>     proj[3][4];         <font class="comment">/* projection matrix of rectified image */</font>
00105   <font class="keywordtype">float</font>     rect[3][3];         <font class="comment">/* rectification transform after correction for lens distortion */</font>
00106 } svsIP;
00107 
00108 <font class="comment">//</font>
00109 <font class="comment">// The svsSP structure stores all info about a stereo image pair and the stereo</font>
00110 <font class="comment">//   calculation.  Used as an argument to most functions.</font>
00111 <font class="comment">//</font>
00112 
00113 <font class="keyword">typedef</font> <font class="keyword">struct </font>{
00114   <font class="keywordtype">int</font> id;
00115 
00116   <font class="comment">/* Transformation of left camera coords to global coords */</font>
00117   <font class="keywordtype">double</font> GTx;            <font class="comment">/* [mm] */</font>
00118   <font class="keywordtype">double</font> GTy;            <font class="comment">/* [mm] */</font>
00119   <font class="keywordtype">double</font> GTz;            <font class="comment">/* [mm] */</font>
00120   <font class="keywordtype">double</font> GRx;            <font class="comment">/* [rad] Yaw */</font>
00121   <font class="keywordtype">double</font> GRy;            <font class="comment">/* [rad] Pitch */</font>
00122   <font class="keywordtype">double</font> GRz;            <font class="comment">/* [rad] Roll */</font>
00123 
00124   <font class="comment">/* Stereo algorithm parameters */</font>
00125   <font class="keywordtype">int</font> convx, convy;             <font class="comment">/* Edge convolution kernel size, pixels */</font>
00126   <font class="keywordtype">int</font> corrxsize, corrysize;   <font class="comment">/* Correlation window size, pixels */</font>
00127   <font class="keywordtype">int</font> thresh;                   <font class="comment">/* Confidence threshold, 0-20 */</font>
00128   <font class="keywordtype">int</font> lr;                       <font class="comment">/* Left/right check, 1=on, 0=off */</font>
00129   <font class="keywordtype">int</font> ndisp;                    <font class="comment">/* Number of pixel disparities to search */</font>
00130   <font class="keywordtype">int</font> dpp;                      <font class="comment">/* Disparities per pixel */</font>
00131   <font class="keywordtype">int</font> offx, offy;               <font class="comment">/* offx is horopter displacement, offy unused */</font>
00132   <font class="keywordtype">double</font>    frame;              <font class="comment">/* framing factor, 1.0 is no scaling, less than 1.0 reduces rectified image */</font>
00133   <font class="comment">// disparity buffer offsets</font>
00134   <font class="keywordtype">int</font> dleft, dtop;              <font class="comment">// offset of disparity image upper left corner</font>
00135   <font class="keywordtype">int</font> dwidth, dheight;          <font class="comment">// disparity image actual width and height</font>
00136 
00137   <font class="comment">/* framegrabber/image parameters absolute parameters */</font>
00138   <font class="keywordtype">int</font> max_linelen;              <font class="comment">/* for NTSC fields, 640 */</font>
00139   <font class="keywordtype">int</font> max_lines;                <font class="comment">/* for NTSC fields, 240 */</font>
00140   <font class="keywordtype">int</font> max_decimation;           <font class="comment">/* 1, 2 or 4 */</font>
00141   <font class="keywordtype">int</font> max_binning;              <font class="comment">/* 1 or 2 */</font>
00142   <font class="keywordtype">double</font> gamma;                 <font class="comment">/* gamma correction needed for display, 1.0 is none */</font>
00143   <font class="keywordtype">int</font> color, color_right;       <font class="comment">/* 0 for monochrome, 1 for color imager */</font>
00144 
00145   <font class="comment">/* digitization parameters */</font>
00146   <font class="keywordtype">int</font> autogain;                 <font class="comment">/* 1 if currently on */</font>
00147   <font class="keywordtype">int</font> autoexposure;      <font class="comment">/* 1 if currently on */</font>
00148   <font class="keywordtype">int</font> autowhite;                <font class="comment">/* 1 if currently on  */</font>
00149   <font class="keywordtype">int</font> autobrightness;           <font class="comment">// 1 if currently on </font>
00150 
00151   <font class="keywordtype">int</font> gain;                     <font class="comment">/* Image gain, from 0 to 100; -1 is auto */</font>
00152   <font class="keywordtype">int</font> exposure;                 <font class="comment">/* Image exposure from 0 to 100, -1 is auto */</font>
00153   <font class="keywordtype">int</font> contrast;                 <font class="comment">/* Image contrast, from 0 to 100, if auto mode */</font>
00154   <font class="keywordtype">int</font> brightness;               <font class="comment">/* Image brightness, from 0 to 100, if auto mode */</font>
00155   <font class="keywordtype">int</font> saturation;               <font class="comment">/* Image color saturation, from 0 to 100 */</font>
00156   <font class="keywordtype">int</font> red;                      <font class="comment">/* Image red gain, from 0 to 100, -1 is auto */</font>
00157   <font class="keywordtype">int</font> blue;                     <font class="comment">/* Image blue gain, from 0 to 100, -1 is auto */</font>
00158 
00159   <font class="comment">/* Image subwindow */</font>
00160   <font class="keywordtype">int</font> ix;                       <font class="comment">/* Subimage start column */</font>
00161   <font class="keywordtype">int</font> iy;                       <font class="comment">/* Subimage start row */</font>
00162   <font class="keywordtype">int</font> width;                    <font class="comment">/* Subimage width, in pixels */</font>
00163   <font class="keywordtype">int</font> height;                   <font class="comment">/* Subimage height, in pixels */</font>
00164   <font class="keywordtype">int</font> vergence;                 <font class="comment">/* Subimage vergence between images */</font>
00165   <font class="keywordtype">int</font> rectified;                <font class="comment">/* 1 if the image is rectified, else 0 */</font>
00166 
00167   <font class="comment">/* warping source subwindow parameters, only used in subwindow warping */</font>
00168   <font class="keywordtype">int</font> subwarp;                  <font class="comment">/* 1 if we're warping subimage, 0 if not */</font>
00169   <font class="keywordtype">int</font> left_ix, left_iy;         <font class="comment">/* source start column and row */</font>
00170   <font class="keywordtype">int</font> left_width, left_height;     <font class="comment">/* source width and height */</font>
00171   <font class="keywordtype">int</font> right_ix, right_iy;       <font class="comment">/* source start column and row */</font>
00172   <font class="keywordtype">int</font> right_width, right_height; <font class="comment">/* source width and height */</font>
00173 
00174   <font class="comment">/* Current full-frame image size */</font>
00175   <font class="keywordtype">int</font> decimation;               <font class="comment">/* current decimation */</font>
00176   <font class="keywordtype">int</font> binning;                  <font class="comment">/* current binning */</font>
00177   <font class="keywordtype">int</font> subwindow;                <font class="comment">/* 1 = subwindow capability, 0 = none */</font>
00178   <font class="comment">/* Parameters below here are important for redoing warping addresses */</font>
00179   <font class="keywordtype">int</font> linelen;                  <font class="comment">/* Image line length, in pixels */</font>
00180   <font class="keywordtype">int</font> lines;                    <font class="comment">/* Number of image lines */</font>
00181 
00182   <font class="comment">/* Internal camera optical parameters */</font>
00183   <font class="keywordtype">int</font> have_rect;                <font class="comment">/* 1 if this structure has valid rectification params */</font>
00184   svsIP  left;                  <font class="comment">/* Left camera parameters */</font>
00185   svsIP  right;                 <font class="comment">/* Right camera parameters */</font>
00186 
00187   <font class="comment">/* Transformation between left and right cameras */</font>
00188   <font class="comment">/* Coordinate system is attached to the center of projection of the
</font>00189 <font class="comment">     left camera, with the X and Y axis aligned with the u and v axis,
</font>00190 <font class="comment">     and Z along the line of sight */</font>
00191   <font class="keywordtype">double</font> Tx;                    <font class="comment">/* [mm] */</font>
00192   <font class="keywordtype">double</font> Ty;                    <font class="comment">/* [mm] */</font>
00193   <font class="keywordtype">double</font> Tz;                    <font class="comment">/* [mm] */</font>
00194   <font class="keywordtype">double</font> Rx;                    <font class="comment">/* [rad] rotation vector */</font>
00195   <font class="keywordtype">double</font> Ry;                    <font class="comment">/* [rad] norm is angle to rotate */</font>
00196   <font class="keywordtype">double</font> Rz;                    <font class="comment">/* [rad] direction is axis of rotation */</font>
00197 
00198   <font class="keywordtype">unsigned</font> <font class="keywordtype">long</font> reserved;
00199 } svsSP;
00200 
00201 
00202 <font class="preprocessor">#define VIDEO_ERROR_FRAME_SIZE   -6
</font>00203 <font class="preprocessor"></font><font class="preprocessor">#define VIDEO_ERROR_FRAME_SAMPLE -2
</font>00204 <font class="preprocessor"></font><font class="preprocessor">#define VIDEO_ERROR_DEC_MODE     -3
</font>00205 <font class="preprocessor"></font><font class="preprocessor">#define VIDEO_ERROR_BIN_MODE     -4
</font>00206 <font class="preprocessor"></font><font class="preprocessor">#define VIDEO_ERROR_SUBWINDOW    -5
</font>00207 <font class="preprocessor"></font>
00208 
00209 <font class="comment">//#define LINE_SIZE 160</font>
00210 <font class="comment">//#define FRAME_SIZE 120</font>
00211 
00212 <font class="comment">/*
</font>00213 <font class="comment"> * Maximum sizes for caches
</font>00214 <font class="comment"> */</font>
00215 <font class="preprocessor">#define MAXX (1280+0)         </font><font class="comment">/* maximum number of columns in image */</font>
00216 <font class="preprocessor">#define MAXY (1032+0)         </font><font class="comment">/* maximum number of rows in image */</font>
00217 <font class="preprocessor">#define MAXD 16               </font><font class="comment">/* stereo search range */</font>
00218 <font class="preprocessor">#define MAXDS 128        </font><font class="comment">/* abs max search range */</font>
00219 <font class="preprocessor">#define MAXW 21               </font><font class="comment">/* max window size */</font>
00220 <font class="preprocessor">#define MAXRVAL 2048          </font><font class="comment">/* maximum range value returned */</font>
00221 <font class="preprocessor">#define SUBPIXELS 16          </font><font class="comment">/* subpixel interpolation size */</font>
00222 
00223 <font class="comment">/* addressing types for warping */</font>
00224 <font class="preprocessor">#define ADDRTYPE int
</font>00225 <font class="preprocessor"></font><font class="preprocessor">#define BILINTYPE struct bilinear_interp
</font>00226 <font class="preprocessor"></font><font class="preprocessor">#define BILINMULT struct bilinear_mult
</font>00227 <font class="preprocessor"></font><font class="preprocessor">#define BILINWRITE struct bilinear_write
</font>00228 <font class="preprocessor"></font><font class="preprocessor">#define BILIN_OFFSET 12
</font>00229 <font class="preprocessor"></font><font class="preprocessor">#define BILIN_DELTA 32
</font>00230 <font class="preprocessor"></font><font class="preprocessor">#define BILIN_TAB_SIZE (BILIN_DELTA * BILIN_DELTA)
</font>00231 <font class="preprocessor"></font>
00232 <font class="keyword">struct </font>bilinear_interp
00233 {
00234   <font class="keywordtype">int</font> iaddr; <font class="keywordtype">short</font> maddr;
00235 };
00236 
00237 <font class="keyword">struct </font>bilinear_mult
00238 {
00239   <font class="keywordtype">short</font> a, b, c, d;
00240 };
00241 
00242 <font class="keyword">struct </font>bilinear_write
00243 {
00244   <font class="keywordtype">int</font> iaddrx, iaddry, oaddrx, oaddry; <font class="keywordtype">double</font> alpha, beta;
00245 };
00246 
00247 <font class="comment">//</font>
00248 <font class="comment">// structure for subwindow warping indices</font>
00249 <font class="comment">// ylow, yhigh are x-indices of where the warped line gets its pixel from,</font>
00250 <font class="comment">//    for the low and high y-values of the line.  They are 0 if it's at the</font>
00251 <font class="comment">//    end of the line, and the index if it's in the middle</font>
00252 <font class="comment">// similarly for xlow, xhigh</font>
00253 <font class="comment">//</font>
00254 
00255 <font class="keyword">struct </font>subwin_index
00256 {
00257   <font class="keywordtype">int</font> xlow, xhigh, ylow, yhigh;
00258 };
00259 
00260 
00261 <font class="preprocessor">#define VID_ROWS 240
</font>00262 <font class="preprocessor"></font><font class="preprocessor">#define VID_COLS 320
</font>00263 <font class="preprocessor"></font><font class="preprocessor">#define XKERNEL 9
</font>00264 <font class="preprocessor"></font><font class="preprocessor">#define YKERNEL 3
</font>00265 <font class="preprocessor"></font><font class="preprocessor">#define XCORR  11
</font>00266 <font class="preprocessor"></font><font class="preprocessor">#define YCORR  11
</font>00267 <font class="preprocessor"></font><font class="preprocessor">#define NUM_DISP 16
</font>00268 <font class="preprocessor"></font>
00269 <font class="comment">/* These macros give offsets and size of the disparity image, relative
</font>00270 <font class="comment"> *   to the left intensity image.  Takes svsSP pointer as the argument. 
</font>00271 <font class="comment"> *   Offsets are in terms of the left image.
</font>00272 <font class="comment"> */</font>
00273 <font class="preprocessor">#define ABS(x) (((x) &lt; 0) ? (-(x)) : (x))
</font>00274 <font class="preprocessor"></font><font class="preprocessor">#define RESWIDTH(p) ((p)-&gt;width - (p)-&gt;convx - (p)-&gt;corrxsize - 2*(p)-&gt;ndisp - \
</font>00275 <font class="preprocessor">                     ABS((p)-&gt;offx) + 4)
</font>00276 <font class="preprocessor"></font><font class="preprocessor">#define RESLEN(p)   ((p)-&gt;height - (p)-&gt;convy - (p)-&gt;corrysize - ABS((p)-&gt;offy) + 2)
</font>00277 <font class="preprocessor"></font><font class="preprocessor">#define RESLEFT(p)  (((p)-&gt;convx +(p)-&gt;corrxsize + (p)-&gt;ndisp + (p)-&gt;ndisp - 4) /2 \
</font>00278 <font class="preprocessor">                     + ((p)-&gt;offx &lt; 0 ? -(p)-&gt;offx : 0))
</font>00279 <font class="preprocessor"></font><font class="preprocessor">#define RESTOP(p)   (((p)-&gt;convy + (p)-&gt;corrysize - 2) / 2 + \
</font>00280 <font class="preprocessor">               ((p)-&gt;offy &lt; 0 ? -(p)-&gt;offy : 0))
</font>00281 <font class="preprocessor"></font>
00282 <font class="comment">/* These macros give offsets and size of the edge image, relative
</font>00283 <font class="comment"> *   to the left intensity image.  Takes svsSP pointer as the argument. 
</font>00284 <font class="comment"> */</font>
00285 <font class="preprocessor">#define EDGEWIDTH(p) (((p)-&gt;linelen) - (p)-&gt;convx + 1)
</font>00286 <font class="preprocessor"></font><font class="preprocessor">#define EDGELEN(p)   (((p)-&gt;height) - (p)-&gt;convy + 1)
</font>00287 <font class="preprocessor"></font><font class="preprocessor">#define EDGELEFT(p)  ((p)-&gt;convx/2)
</font>00288 <font class="preprocessor"></font><font class="preprocessor">#define EDGETOP(p)   ((p)-&gt;convy/2)
</font>00289 <font class="preprocessor"></font>
00290 <font class="comment">/* display mode */</font>
00291 <font class="preprocessor">#define DISP_NONE   0
</font>00292 <font class="preprocessor"></font><font class="preprocessor">#define DISP_LEFT   1
</font>00293 <font class="preprocessor"></font><font class="preprocessor">#define DISP_RIGHT  2
</font>00294 <font class="preprocessor"></font><font class="preprocessor">#define DISP_BOTH   3
</font>00295 <font class="preprocessor"></font><font class="preprocessor">#define DISP_MOSAIC 4
</font>00296 <font class="preprocessor"></font><font class="preprocessor">#define DISP_HIST   5
</font>00297 <font class="preprocessor"></font><font class="preprocessor">#define DISP_IMAGE  6
</font>00298 <font class="preprocessor"></font><font class="preprocessor">#define DISP_X1     7
</font>00299 <font class="preprocessor"></font><font class="preprocessor">#define DISP_X2     8
</font>00300 <font class="preprocessor"></font>
00301 <font class="comment">/* acquisition mode */</font>
00302 <font class="preprocessor">#define AQ_SINGLE     1
</font>00303 <font class="preprocessor"></font><font class="preprocessor">#define AQ_CONTIN     2
</font>00304 <font class="preprocessor"></font><font class="preprocessor">#define AQ_FREEZE    11
</font>00305 <font class="preprocessor"></font><font class="preprocessor">#define AQ_CALIBRATE 10
</font>00306 <font class="preprocessor"></font>
00307 <font class="comment">/* GM:acquisition type */</font>
00308 <font class="preprocessor">#define AQT_SVM       3
</font>00309 <font class="preprocessor"></font><font class="preprocessor">#define AQT_BUFFER    4
</font>00310 <font class="preprocessor"></font><font class="preprocessor">#define AQT_FRAMEGRAB 5
</font>00311 <font class="preprocessor"></font><font class="preprocessor">#define AQT_NONE      6
</font>00312 <font class="preprocessor"></font><font class="preprocessor">#define AQT_FILE      7
</font>00313 <font class="preprocessor"></font>
00314 <font class="comment">/* capture formats */</font>
00315 <font class="preprocessor">#define CAP_INTERLACE   0
</font>00316 <font class="preprocessor"></font><font class="preprocessor">#define CAP_RGCOMPONENT 1
</font>00317 <font class="preprocessor"></font><font class="preprocessor">#define CAP_DUAL        2
</font>00318 <font class="preprocessor"></font><font class="preprocessor">#define CAP_TRIPLE      3
</font>00319 <font class="preprocessor"></font><font class="preprocessor">#define CAP_CHANNELS    4
</font>00320 <font class="preprocessor"></font>
00321 <font class="preprocessor">#define BI_YVU9  0x39555659        // YVU9, planar
</font>00322 <font class="preprocessor"></font><font class="preprocessor">#define BI_YV12  0x32315659        // YVU12 (4:1:1), planar
</font>00323 <font class="preprocessor"></font><font class="preprocessor">#define BI_I420  0x30323449        // YUV12 (4:2:0), planar 
</font>00324 <font class="preprocessor"></font><font class="preprocessor">#define BI_I422  0x32323449        // YUV12 (4:1:1), planar
</font>00325 <font class="preprocessor"></font><font class="preprocessor">#define BI_MRG2  0x3247524d        // YUV16 (4:2:2) ??
</font>00326 <font class="preprocessor"></font>
00327 <font class="comment">/*
</font>00328 <font class="comment"> * SVS video capture main functions
</font>00329 <font class="comment"> */</font>
00330 
00331 IMPORT <font class="keyword">extern</font> <font class="keywordtype">char</font> *svsVideoIdent;  <font class="comment">// identifier string for this capture interface</font>
00332 
00333 
00334 <font class="comment">// Debugging callbacks</font>
00335 IMPORT <font class="keyword">extern</font> void (*capDebug)(<font class="keywordtype">char</font> *str);
00336 IMPORT <font class="keyword">extern</font> void (*svsDebug)(<font class="keywordtype">int</font> level, <font class="keywordtype">char</font> *str);
00337 IMPORT <font class="keywordtype">void</font> svsDebugMessage(<font class="keywordtype">int</font> level, <font class="keywordtype">char</font> *str, ...);
00338 
00339 
00340 <font class="comment">/* 
</font>00341 <font class="comment"> * Sometimes we need to say which image we want
</font>00342 <font class="comment"> */</font>
00343 
00344 <font class="preprocessor">#define svsLEFT  100
</font>00345 <font class="preprocessor"></font><font class="preprocessor">#define svsRIGHT 101
</font>00346 <font class="preprocessor"></font><font class="preprocessor">#define svsBOTH  102
</font>00347 <font class="preprocessor"></font><font class="preprocessor">#define svsLEFTCOLOR 103
</font>00348 <font class="preprocessor"></font><font class="preprocessor">#define svsRIGHTCOLOR 104
</font>00349 <font class="preprocessor"></font><font class="preprocessor">#define svsLEFTBAYER 105
</font>00350 <font class="preprocessor"></font><font class="preprocessor">#define svsRIGHTBAYER 106
</font>00351 <font class="preprocessor"></font>
00352 
00353 <font class="comment">/*
</font>00354 <font class="comment"> * display output
</font>00355 <font class="comment"> */</font>
00356 <font class="preprocessor">#define svsNONE       0
</font>00357 <font class="preprocessor"></font><font class="preprocessor">#define svsSTEREO     1
</font>00358 <font class="preprocessor"></font><font class="preprocessor">#define svsDISPARITY  1
</font>00359 <font class="preprocessor"></font><font class="preprocessor">#define svsCONFIDENCE 2
</font>00360 <font class="preprocessor"></font><font class="preprocessor">#define svsEDGES      3
</font>00361 <font class="preprocessor"></font><font class="preprocessor">#define svsMOTION     4
</font>00362 <font class="preprocessor"></font><font class="preprocessor">#define svsCOLOR      5
</font>00363 <font class="preprocessor"></font><font class="preprocessor">#define svsRGB24      5
</font>00364 <font class="preprocessor"></font><font class="preprocessor">#define svsMONOCHROME 6
</font>00365 <font class="preprocessor"></font>
00366 <font class="comment">/*
</font>00367 <font class="comment"> * Calculations
</font>00368 <font class="comment"> */</font>
00369 
00370 <font class="comment">/* MMX definition */</font>
00371 REALLYIMPORT <font class="keyword">extern</font> <font class="keywordtype">int</font> svsHasMMX; <font class="comment">/* 1 for MMX, 0 for none, -1 for not checked. 
</font>00372 <font class="comment">                       Can be set or read */</font>
00373 REALLYIMPORT <font class="keyword">extern</font> svsSP svsParams;
00374 
00375 IMPORT <font class="keywordtype">int</font> svsCheckMMX(<font class="keywordtype">void</font>); <font class="comment">/* Checks for MMX and sets svsHasMMX */</font>
00376 
00377 
00378 <font class="preprocessor">#define LRVAL     0xfffe </font><font class="comment">/* failed LR check */</font>
00379 <font class="preprocessor">#define THRESHVAL 0xffff </font><font class="comment">/* failed texture threshold */</font>
00380 
00381 <font class="comment">/*
</font>00382 <font class="comment"> * Display functions
</font>00383 <font class="comment"> */</font>
00384 
00385 IMPORT <font class="keyword">extern</font> <font class="keywordtype">void</font> svsSleep(<font class="keywordtype">int</font> ms); <font class="comment">/* wait this long in milliseconds */</font>
00386 
00387 <font class="preprocessor">#ifdef UNIX
</font>00388 <font class="preprocessor"></font><font class="preprocessor">#endif
</font>00389 <font class="preprocessor"></font>
00390 <font class="preprocessor">#ifdef WIN32
</font>00391 <font class="preprocessor"></font>IMPORT <font class="keyword">extern</font> HWND svsMainWin;          <font class="comment">/* main window handle */</font>
00392 <font class="preprocessor">#endif
</font>00393 <font class="preprocessor"></font>
00394 <font class="comment">/*
</font>00395 <font class="comment"> * image file I/O
</font>00396 <font class="comment"> */</font>
00397 
00398 <font class="preprocessor">#define HEADER_STRING "srisunim"
</font>00399 <font class="preprocessor"></font>
00400 <font class="preprocessor">#define HEADER_TYPE 0
</font>00401 <font class="preprocessor"></font><font class="preprocessor">#define DATA_INT 0
</font>00402 <font class="preprocessor"></font><font class="preprocessor">#define DATA_FLOAT 1
</font>00403 <font class="preprocessor"></font><font class="preprocessor">#define HEADER_SIZE 256
</font>00404 <font class="preprocessor"></font>
00405 <font class="comment">/* whole structure should take 256 bytes */</font>
00406 <font class="keyword">struct  </font>srisunim_header
00407 { 
00408     <font class="keywordtype">char</font> srisunim[8];
00409     <font class="keywordtype">char</font> header_type;
00410     <font class="keywordtype">char</font> data_type;
00411     <font class="keywordtype">char</font> bits_per_pixel;
00412     <font class="keywordtype">char</font> n_dimensions;
00413     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> x_dimension_h;
00414     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> x_dimension_l;
00415     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> y_dimension_h;
00416     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> y_dimension_l;
00417     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> z_dimension_h;
00418     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> z_dimension_l;
00419     <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> n_images;   <font class="comment">/* number of images */</font>
00420     <font class="keywordtype">char</font> padding[237];
00421   };
00422     
00423 <font class="comment">/* Reads an .ssi file and put contents into buffer.  Creates
</font>00424 <font class="comment">   buffer if null. */</font>
00425 IMPORT <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *svsReadFile(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *buffer, 
00426                   <font class="keywordtype">int</font> *height, <font class="keywordtype">int</font> *width, <font class="keywordtype">int</font> *num);
00427 IMPORT <font class="keywordtype">int</font> svsWriteImage(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *buf, <font class="keywordtype">int</font> width, 
00428                 <font class="keywordtype">int</font> height, <font class="keywordtype">char</font> *type, <font class="keywordtype">int</font> numframes);
00429 <font class="comment">// bpp should be either 8 or 24; error if file doesn't match</font>
00430 IMPORT <font class="keywordtype">int</font> svsReadFileSizeBMP(<font class="keywordtype">char</font> *name, <font class="keywordtype">int</font> *width, <font class="keywordtype">int</font> *height, <font class="keywordtype">int</font> bpp);
00431 IMPORT <font class="keywordtype">int</font> svsReadFileBMP(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *buffer, 
00432                   <font class="keywordtype">int</font> *width, <font class="keywordtype">int</font> *height, <font class="keywordtype">int</font> interlace);
00433 IMPORT <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *svsReadFile2BMP(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *buffer, 
00434                   <font class="keywordtype">int</font> *width, <font class="keywordtype">int</font> *height);
00435 IMPORT <font class="keywordtype">int</font> svsWriteImageBMP(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *im, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, 
00436                     <font class="keywordtype">int</font> isDisparity);
00437 IMPORT <font class="keywordtype">int</font> svsWriteImageColorBMP(<font class="keywordtype">char</font> *name, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *im, <font class="keywordtype">int</font> width, <font class="keywordtype">int</font> height, 
00438                      <font class="keywordtype">int</font> isDisparity);
00439 IMPORT <font class="keywordtype">int</font>
00440 svsWrite3DArray(<font class="keywordtype">char</font> *fname, <font class="keywordtype">float</font> *X, <font class="keywordtype">float</font> *Y, <font class="keywordtype">float</font> *Z, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *image, 
00441           <font class="keywordtype">short</font> *disp, <font class="keywordtype">int</font> type, svsSP *sp);
00442 IMPORT <font class="keywordtype">int</font>
00443 svsWrite3DCloud(<font class="keywordtype">char</font> *fname, <font class="keywordtype">float</font> *X, <font class="keywordtype">float</font> *Y, <font class="keywordtype">float</font> *Z, <font class="keywordtype">unsigned</font> <font class="keywordtype">char</font> *image, 
00444           <font class="keywordtype">short</font> *disp, <font class="keywordtype">int</font> type, svsSP *sp, <font class="keywordtype">int</font> nump);
00445 IMPORT <font class="keywordtype">int</font> svsWriteDisparity(<font class="keywordtype">char</font> *fname, <font class="keywordtype">short</font> *disp, svsSP *sp);
00446 
00447 
00448 IMPORT <font class="keyword">extern</font> <font class="keywordtype">char</font> *svsError;
00449 IMPORT <font class="keywordtype">int</font> svsWriteParamFile(<font class="keywordtype">char</font> *fname, svsSP *sp);  <font class="comment">/* writes out stereo setting */</font>
00450 IMPORT <font class="keywordtype">int</font> svsWriteRectFile(<font class="keywordtype">char</font> *fname, svsSP *sp);   <font class="comment">/* writes out stereo rectification */</font>
00451 IMPORT <font class="keywordtype">int</font> svsReadParamFile(<font class="keywordtype">char</font> *fname, svsSP *sp);   <font class="comment">/* reads in stereo setting */</font>
00452 
00453 
00454 
00455 <font class="comment">/* version of the software */</font>
00456 <font class="preprocessor">#define engine_version 32
</font>00457 <font class="preprocessor"></font>IMPORT <font class="keyword">extern</font> <font class="keywordtype">int</font> svsEngineVersion;
00458 <font class="preprocessor">#define engine_subversion 'a'
</font>00459 <font class="preprocessor"></font>IMPORT <font class="keyword">extern</font> <font class="keywordtype">char</font> svsEngineSubVersion;
00460 
00461 IMPORT <font class="keyword">extern</font> <font class="keywordtype">int</font> svsPreFilterTime, svsPostFilterTime, svsCorrTime, svsMaxTime;
00462 
00463 <font class="comment">//</font>
00464 <font class="comment">// new FLTK-based drawing fns</font>
00465 <font class="comment">//</font>
00466 
00467 IMPORT <font class="keywordtype">int</font>  fltk_check(<font class="keywordtype">void</font>); <font class="comment">/* process fltk events */</font>
00468 
00469 <font class="preprocessor">#endif    </font><font class="comment">/* ifdef _svs_h_ */</font>
</div></pre><hr><address><small>Generated at Fri Oct 26 00:17:16 2007 for XVision by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
